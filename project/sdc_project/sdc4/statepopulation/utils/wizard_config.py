"""
Wizard Step Configuration for Statepopulation.

This module contains configuration generated from the DM at app generation time.
It determines which wizard steps are visible based on the DM's structure.

DO NOT EDIT MANUALLY - This file is generated by SDCStudio AppGen.
"""
from typing import List, Dict, Any


class WizardStepConfig:
    """
    Configuration for wizard step visibility and behavior.

    Generated from DM at app generation time based on:
    - DM.subject (Party)
    - DM.provider (Party)
    - DM.participations (M2M Participation)
    - DM.protocol (XdString)
    - DM.workflow (XdLink)
    - DM.audit (M2M Audit)
    - DM.attestation (Attestation)
    """

    # ==========================================================================
    # DM-Level Feature Flags (Set at generation time)
    # ==========================================================================

    # Context elements (Step 1)
    HAS_SUBJECT = False
    HAS_PROVIDER = False
    HAS_PARTICIPATIONS = False

    # Setup elements (Step 0)
    HAS_PROTOCOL = False
    HAS_WORKFLOW = False

    # Provenance elements (Step 3)
    HAS_AUDIT = False
    HAS_ATTESTATION = False

    # ==========================================================================
    # Step Visibility Methods
    # ==========================================================================

    @classmethod
    def show_context_step(cls) -> bool:
        """
        Step 1 (Context) is shown if any of these DM elements exist:
        - subject: Party for who the data is about
        - provider: Party for who provided the data
        - participations: Other parties involved
        """
        return cls.HAS_SUBJECT or cls.HAS_PROVIDER or cls.HAS_PARTICIPATIONS

    @classmethod
    def show_attestation_step(cls) -> bool:
        """
        Step 3 (Review & Attestation) is shown if:
        - audit: Audit trail is configured
        - attestation: Data attestation is required
        """
        return cls.HAS_AUDIT or cls.HAS_ATTESTATION

    @classmethod
    def get_visible_steps(cls) -> List[int]:
        """
        Get list of visible step numbers based on DM configuration.

        Returns:
            List of step numbers (0-3) that should be shown
        """
        # Steps 0 (Setup) and 2 (Data Entry) are always visible
        steps = [0, 2]

        # Step 1 (Context) is conditional
        if cls.show_context_step():
            steps.insert(1, 1)

        # Step 3 (Review & Attestation) is conditional
        if cls.show_attestation_step():
            steps.append(3)

        return sorted(steps)

    @classmethod
    def get_step_count(cls) -> int:
        """Get total number of visible steps."""
        return len(cls.get_visible_steps())

    @classmethod
    def get_step_names(cls) -> Dict[int, str]:
        """
        Get human-readable names for each step.

        Returns:
            Dictionary mapping step number to display name
        """
        names = {
            0: 'Setup',
            2: 'Data Entry',
        }

        if cls.show_context_step():
            names[1] = 'Context'

        if cls.show_attestation_step():
            names[3] = 'Review & Submit'

        return names

    @classmethod
    def get_next_step(cls, current: int) -> int:
        """
        Get the next visible step after the current one.

        Args:
            current: Current step number

        Returns:
            Next visible step number, or -1 if at the end
        """
        visible = cls.get_visible_steps()
        try:
            idx = visible.index(current)
            if idx < len(visible) - 1:
                return visible[idx + 1]
        except ValueError:
            pass
        return -1

    @classmethod
    def get_prev_step(cls, current: int) -> int:
        """
        Get the previous visible step before the current one.

        Args:
            current: Current step number

        Returns:
            Previous visible step number, or -1 if at the beginning
        """
        visible = cls.get_visible_steps()
        try:
            idx = visible.index(current)
            if idx > 0:
                return visible[idx - 1]
        except ValueError:
            pass
        return -1

    @classmethod
    def is_last_step(cls, step: int) -> bool:
        """Check if this is the last visible step."""
        visible = cls.get_visible_steps()
        return step == visible[-1] if visible else False

    @classmethod
    def is_first_step(cls, step: int) -> bool:
        """Check if this is the first visible step."""
        visible = cls.get_visible_steps()
        return step == visible[0] if visible else False


# =============================================================================
# DM Metadata (Read-only at runtime)
# =============================================================================

class DMMetadata:
    """
    Static DM metadata embedded at generation time.
    These values are displayed in the wizard but cannot be edited.
    """

    CT_ID = 'its7j6bvrb9n2fxdcxmoemod'
    TITLE = 'Statepopulation'
    DESCRIPTION = '''The 'StatePopulation' dataset provides demographic information for US states, specifically focusing on total population, adult population, and the percentage of the adult population. It allows for an understanding of the adult demographic composition within each state.'''
    LANGUAGE = 'en-US'
    ENCODING = 'utf-8'

    # Dublin Core metadata
    DC_SUBJECT = ''''''
    DC_RIGHTS = ''''''
    DC_PUBLISHER = ''''''


# =============================================================================
# Component Metadata (for form generation)
# =============================================================================

# This will be populated by the generator with full component tree info
COMPONENT_TREE = {'label': 'StatePopulation Data Cluster', 'ct_id': 'its7j6bvrb9n2fxdcxmoemod', 'type': 'DataCluster', 'description': 'Data cluster containing 4 columns\nBusiness Context: Contains 4 columns of mixed data types\nPurpose: Organize all data columns for the dataset', 'children': [{'label': 'State', 'ct_id': 'poq4ywx89zvijxwoqz8djrxj', 'type': 'XdString', 'description': 'This column represents the U.S. state where a particular entity, such as a customer, business location, or transaction, is geographically situated. This data is crucial for regional sales analysis, targeted marketing campaigns, supply chain optimization, and understanding market penetration across different administrative divisions of the United States.  It enables businesses to segment their operations and customer base by state, facilitating localized strategies and compliance with state-specific regulations.\nBusiness Rules: Each value should correspond to a valid U.S. state., Values may include a leading period as a formatting artifact., The data is expected to be a subset of the 50 U.S. states and potentially the District of Columbia., Consistency in state naming convention is expected for accurate aggregation and analysis.', 'required': False, 'ui_type': 'choose', 'seq': '0000', 'children': [], 'allow_vtb': True, 'allow_vte': True, 'allow_tr': True}, {'label': 'Adult Population', 'ct_id': 'ac79bjkqi8906qzjujpwtlsy', 'type': 'XdCount', 'description': 'This column represents the total number of individuals within a defined geographic area or demographic segment who are considered adults. This data is crucial for understanding the potential consumer base, workforce availability, and demand for adult-oriented services and products, informing strategic decisions in marketing, urban planning, and public policy.\nBusiness Rules: Adult population typically refers to individuals aged 18 years or older., The data should represent a discrete count and cannot be fractional., Values are expected to be non-negative.', 'required': False, 'ui_type': 'choose', 'seq': '0000', 'children': [], 'units': {'ct_id': 'y0wjrexefsmsebpu0rnf8da9', 'label': 'Adult Population_units', 'symbols': []}, 'allow_vtb': True, 'allow_vte': True, 'allow_tr': True}, {'label': 'Total Population', 'ct_id': 'w30d6kzcdcfnjxvk94w58nfw', 'type': 'XdCount', 'description': 'This column represents the total number of individuals residing within a defined geographic area, such as a city, state, or country. This demographic data is crucial for urban planning, resource allocation (e.g., healthcare, education, infrastructure), market segmentation, and understanding population density for strategic business decisions and policy development.\nBusiness Rules: Population counts are typically non-negative integers., Data is usually collected through official census operations or reliable demographic estimations., Counts may be subject to periodic updates to reflect population changes., Values should be consistent with the defined geographic boundaries they represent.', 'required': False, 'ui_type': 'choose', 'seq': '0000', 'children': [], 'units': {'ct_id': 'ko1ndwdc6kh8jr39dn9x3wpi', 'label': 'Total Population_units', 'symbols': []}, 'allow_vtb': True, 'allow_vte': True, 'allow_tr': True}, {'label': 'Adult Population Percentage', 'ct_id': 'hzsoktbrtlhowsl71kywg81w', 'type': 'XdQuantity', 'description': "This column represents the proportion of the total population that is classified as 'adult' within a given geographic or demographic segment. It is a critical metric for understanding the age structure of a population, directly influencing market segmentation, resource allocation for services catering to adults (e.g., employment programs, adult education, healthcare services), and strategic planning for businesses and government agencies.\nBusiness Rules: Values are expected to be between 0.0 and 100.0., Represents a proportion, so values should generally be greater than 50% in most developed regions., Data is typically aggregated from census or survey data.", 'required': False, 'ui_type': 'choose', 'seq': '0000', 'children': [], 'units': {'ct_id': 'w9prqlh0m9jdng93uwz6hqwz', 'label': 'Adult Population Percentage_units', 'symbols': []}, 'allow_vtb': True, 'allow_vte': True, 'allow_tr': True}]}

# Field metadata for value extraction
FIELD_METADATA = {'poq4ywx89zvijxwoqz8djrxj': {'label': 'State', 'type': 'XdString', 'required': False, 'constraints': {}, 'help_text': 'This column represents the U.S. state where a particular entity, such as a customer, business location, or transaction, is geographically situated. This data is crucial for regional sales analysis, targeted marketing campaigns, supply chain optimization, and understanding market penetration across different administrative divisions of the United States.  It enables businesses to segment their operations and customer base by state, facilitating localized strategies and compliance with state-specific regulations.\nBusiness Rules: Each value should correspond to a valid U.S. state., Values may include a leading period as a formatting artifact., The data is expected to be a subset of the 50 U.S. states and potentially the District of Columbia., Consistency in state naming convention is expected for accurate aggregation and analysis.', 'temporal_types': [], 'ui_type': 'choose', 'units': None, 'allow_vtb': True, 'allow_vte': True, 'allow_tr': True, 'allow_modified': False, 'allow_latitude': False, 'allow_longitude': False}, 'ac79bjkqi8906qzjujpwtlsy': {'label': 'Adult Population', 'type': 'XdCount', 'required': False, 'constraints': {}, 'help_text': 'This column represents the total number of individuals within a defined geographic area or demographic segment who are considered adults. This data is crucial for understanding the potential consumer base, workforce availability, and demand for adult-oriented services and products, informing strategic decisions in marketing, urban planning, and public policy.\nBusiness Rules: Adult population typically refers to individuals aged 18 years or older., The data should represent a discrete count and cannot be fractional., Values are expected to be non-negative.', 'temporal_types': [], 'ui_type': 'choose', 'units': {'ct_id': 'y0wjrexefsmsebpu0rnf8da9', 'label': 'Adult Population_units', 'symbols': []}, 'allow_vtb': True, 'allow_vte': True, 'allow_tr': True, 'allow_modified': False, 'allow_latitude': False, 'allow_longitude': False}, 'w30d6kzcdcfnjxvk94w58nfw': {'label': 'Total Population', 'type': 'XdCount', 'required': False, 'constraints': {}, 'help_text': 'This column represents the total number of individuals residing within a defined geographic area, such as a city, state, or country. This demographic data is crucial for urban planning, resource allocation (e.g., healthcare, education, infrastructure), market segmentation, and understanding population density for strategic business decisions and policy development.\nBusiness Rules: Population counts are typically non-negative integers., Data is usually collected through official census operations or reliable demographic estimations., Counts may be subject to periodic updates to reflect population changes., Values should be consistent with the defined geographic boundaries they represent.', 'temporal_types': [], 'ui_type': 'choose', 'units': {'ct_id': 'ko1ndwdc6kh8jr39dn9x3wpi', 'label': 'Total Population_units', 'symbols': []}, 'allow_vtb': True, 'allow_vte': True, 'allow_tr': True, 'allow_modified': False, 'allow_latitude': False, 'allow_longitude': False}, 'hzsoktbrtlhowsl71kywg81w': {'label': 'Adult Population Percentage', 'type': 'XdQuantity', 'required': False, 'constraints': {}, 'help_text': "This column represents the proportion of the total population that is classified as 'adult' within a given geographic or demographic segment. It is a critical metric for understanding the age structure of a population, directly influencing market segmentation, resource allocation for services catering to adults (e.g., employment programs, adult education, healthcare services), and strategic planning for businesses and government agencies.\nBusiness Rules: Values are expected to be between 0.0 and 100.0., Represents a proportion, so values should generally be greater than 50% in most developed regions., Data is typically aggregated from census or survey data.", 'temporal_types': [], 'ui_type': 'choose', 'units': {'ct_id': 'w9prqlh0m9jdng93uwz6hqwz', 'label': 'Adult Population Percentage_units', 'symbols': []}, 'allow_vtb': True, 'allow_vte': True, 'allow_tr': True, 'allow_modified': False, 'allow_latitude': False, 'allow_longitude': False}}
