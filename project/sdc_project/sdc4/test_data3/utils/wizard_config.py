"""
Wizard Step Configuration for TestData3.

This module contains configuration generated from the DM at app generation time.
It determines which wizard steps are visible based on the DM's structure.

DO NOT EDIT MANUALLY - This file is generated by SDCStudio AppGen.
"""
from typing import List, Dict, Any


class WizardStepConfig:
    """
    Configuration for wizard step visibility and behavior.

    Generated from DM at app generation time based on:
    - DM.subject (Party)
    - DM.provider (Party)
    - DM.participations (M2M Participation)
    - DM.protocol (XdString)
    - DM.workflow (XdLink)
    - DM.audit (M2M Audit)
    - DM.attestation (Attestation)
    """

    # ==========================================================================
    # DM-Level Feature Flags (Set at generation time)
    # ==========================================================================

    # Context elements (Step 1)
    HAS_SUBJECT = False
    HAS_PROVIDER = False
    HAS_PARTICIPATIONS = False

    # Setup elements (Step 0)
    HAS_PROTOCOL = False
    HAS_WORKFLOW = False

    # Provenance elements (Step 3)
    HAS_AUDIT = False
    HAS_ATTESTATION = False

    # ==========================================================================
    # Step Visibility Methods
    # ==========================================================================

    @classmethod
    def show_context_step(cls) -> bool:
        """
        Step 1 (Context) is shown if any of these DM elements exist:
        - subject: Party for who the data is about
        - provider: Party for who provided the data
        - participations: Other parties involved
        """
        return cls.HAS_SUBJECT or cls.HAS_PROVIDER or cls.HAS_PARTICIPATIONS

    @classmethod
    def show_attestation_step(cls) -> bool:
        """
        Step 3 (Review & Attestation) is shown if:
        - audit: Audit trail is configured
        - attestation: Data attestation is required
        """
        return cls.HAS_AUDIT or cls.HAS_ATTESTATION

    @classmethod
    def get_visible_steps(cls) -> List[int]:
        """
        Get list of visible step numbers based on DM configuration.

        Returns:
            List of step numbers (0-3) that should be shown
        """
        # Steps 0 (Setup) and 2 (Data Entry) are always visible
        steps = [0, 2]

        # Step 1 (Context) is conditional
        if cls.show_context_step():
            steps.insert(1, 1)

        # Step 3 (Review & Attestation) is conditional
        if cls.show_attestation_step():
            steps.append(3)

        return sorted(steps)

    @classmethod
    def get_step_count(cls) -> int:
        """Get total number of visible steps."""
        return len(cls.get_visible_steps())

    @classmethod
    def get_step_names(cls) -> Dict[int, str]:
        """
        Get human-readable names for each step.

        Returns:
            Dictionary mapping step number to display name
        """
        names = {
            0: 'Setup',
            2: 'Data Entry',
        }

        if cls.show_context_step():
            names[1] = 'Context'

        if cls.show_attestation_step():
            names[3] = 'Review & Submit'

        return names

    @classmethod
    def get_next_step(cls, current: int) -> int:
        """
        Get the next visible step after the current one.

        Args:
            current: Current step number

        Returns:
            Next visible step number, or -1 if at the end
        """
        visible = cls.get_visible_steps()
        try:
            idx = visible.index(current)
            if idx < len(visible) - 1:
                return visible[idx + 1]
        except ValueError:
            pass
        return -1

    @classmethod
    def get_prev_step(cls, current: int) -> int:
        """
        Get the previous visible step before the current one.

        Args:
            current: Current step number

        Returns:
            Previous visible step number, or -1 if at the beginning
        """
        visible = cls.get_visible_steps()
        try:
            idx = visible.index(current)
            if idx > 0:
                return visible[idx - 1]
        except ValueError:
            pass
        return -1

    @classmethod
    def is_last_step(cls, step: int) -> bool:
        """Check if this is the last visible step."""
        visible = cls.get_visible_steps()
        return step == visible[-1] if visible else False

    @classmethod
    def is_first_step(cls, step: int) -> bool:
        """Check if this is the first visible step."""
        visible = cls.get_visible_steps()
        return step == visible[0] if visible else False


# =============================================================================
# DM Metadata (Read-only at runtime)
# =============================================================================

class DMMetadata:
    """
    Static DM metadata embedded at generation time.
    These values are displayed in the wizard but cannot be edited.
    """

    CT_ID = 'rb46xg2fk464oqmlmyejpn2j'
    TITLE = 'TestData3'
    DESCRIPTION = '''The dataset 'test_data3' contains personal information for individuals, including their first name, last name, date of birth, and city of residence. It appears to be a small sample dataset designed for testing or demonstration purposes.'''
    LANGUAGE = 'en-US'
    ENCODING = 'utf-8'

    # Dublin Core metadata
    DC_SUBJECT = ''''''
    DC_RIGHTS = ''''''
    DC_PUBLISHER = ''''''


# =============================================================================
# Component Metadata (for form generation)
# =============================================================================

# This will be populated by the generator with full component tree info
COMPONENT_TREE = {'label': 'test_data3 Data Cluster', 'ct_id': 'rb46xg2fk464oqmlmyejpn2j', 'type': 'DataCluster', 'description': 'Data cluster containing 4 columns\nBusiness Context: Contains 4 columns of mixed data types\nPurpose: Organize all data columns for the dataset', 'children': [{'label': 'City', 'ct_id': 'd4wc1mtex0sd3hbg7fihwpad', 'type': 'XdString', 'description': "This column represents the specific municipality or city where a business entity, customer, or event is located. It is crucial for geographical segmentation, targeted marketing campaigns, supply chain optimization, and understanding regional market dynamics. Accurate city data enables businesses to tailor their strategies to local demographics, economic conditions, and competitive landscapes.\nBusiness Rules: Each entry must represent a recognized city name., City names should be standardized to avoid variations (e.g., 'St. Louis' vs. 'Saint Louis')., May be associated with a state and country for disambiguation and broader geographic analysis.", 'required': False, 'ui_type': 'choose', 'seq': '0000', 'children': [], 'allow_vtb': True, 'allow_vte': True, 'allow_tr': True}, {'label': 'First Name', 'ct_id': 'zvstazokgwfad9ua6in2npc5', 'type': 'XdString', 'description': "This column represents the given name of an individual, a fundamental piece of personal identification used across various business functions. It is primarily collected for customer relationship management (CRM), personalization of communications, and for establishing a direct, informal connection with individuals in marketing, sales, and service contexts.\nBusiness Rules: First names are typically alphanumeric strings., May contain spaces for compound names (e.g., 'Mary Ann')., Case sensitivity may vary depending on system implementation., Should ideally be non-empty for valid records., May be subject to data cleansing to remove special characters or extraneous information.", 'required': False, 'ui_type': 'choose', 'seq': '0000', 'children': [], 'allow_vtb': True, 'allow_vte': True, 'allow_tr': True}, {'label': 'Last Name', 'ct_id': 'jrzt7pvb6xuwjshwftppgbxp', 'type': 'XdString', 'description': "This column represents the surname of an individual, a fundamental identifier used in customer relationship management (CRM), human resources (HR), and identity verification processes. It is crucial for distinguishing individuals within a dataset, enabling accurate record linkage, personalized communication, and compliance with legal and regulatory requirements for data management.\nBusiness Rules: Last names are typically alphanumeric strings., May contain hyphens or apostrophes (e.g., O'Malley, Smith-Jones)., Case sensitivity may vary depending on system configuration., Should not be empty or null for valid individual records., May be subject to data standardization or normalization processes to handle variations in spelling or transliteration.", 'required': False, 'ui_type': 'choose', 'seq': '0000', 'children': [], 'allow_vtb': True, 'allow_vte': True, 'allow_tr': True}, {'label': 'Date of Birth', 'ct_id': 'aiao7fzq1yqhw02vu564melh', 'type': 'XdTemporal', 'description': 'This column represents the date of birth for individuals. The data is consistently formatted and appears to be valid dates.\nBusiness Rules: Dates of birth must be valid calendar dates., Dates of birth should generally fall within a reasonable human lifespan (e.g., not in the future or excessively far in the past)., The format must be YYYY-MM-DD.', 'required': False, 'ui_type': 'choose', 'seq': '0000', 'children': [], 'allow_vtb': True, 'allow_vte': True, 'allow_tr': True}]}

# Field metadata for value extraction
FIELD_METADATA = {'d4wc1mtex0sd3hbg7fihwpad': {'label': 'City', 'type': 'XdString', 'required': False, 'constraints': {}, 'help_text': "This column represents the specific municipality or city where a business entity, customer, or event is located. It is crucial for geographical segmentation, targeted marketing campaigns, supply chain optimization, and understanding regional market dynamics. Accurate city data enables businesses to tailor their strategies to local demographics, economic conditions, and competitive landscapes.\nBusiness Rules: Each entry must represent a recognized city name., City names should be standardized to avoid variations (e.g., 'St. Louis' vs. 'Saint Louis')., May be associated with a state and country for disambiguation and broader geographic analysis.", 'temporal_types': [], 'ui_type': 'choose', 'units': None, 'allow_vtb': True, 'allow_vte': True, 'allow_tr': True, 'allow_modified': False, 'allow_latitude': False, 'allow_longitude': False}, 'zvstazokgwfad9ua6in2npc5': {'label': 'First Name', 'type': 'XdString', 'required': False, 'constraints': {}, 'help_text': "This column represents the given name of an individual, a fundamental piece of personal identification used across various business functions. It is primarily collected for customer relationship management (CRM), personalization of communications, and for establishing a direct, informal connection with individuals in marketing, sales, and service contexts.\nBusiness Rules: First names are typically alphanumeric strings., May contain spaces for compound names (e.g., 'Mary Ann')., Case sensitivity may vary depending on system implementation., Should ideally be non-empty for valid records., May be subject to data cleansing to remove special characters or extraneous information.", 'temporal_types': [], 'ui_type': 'choose', 'units': None, 'allow_vtb': True, 'allow_vte': True, 'allow_tr': True, 'allow_modified': False, 'allow_latitude': False, 'allow_longitude': False}, 'jrzt7pvb6xuwjshwftppgbxp': {'label': 'Last Name', 'type': 'XdString', 'required': False, 'constraints': {}, 'help_text': "This column represents the surname of an individual, a fundamental identifier used in customer relationship management (CRM), human resources (HR), and identity verification processes. It is crucial for distinguishing individuals within a dataset, enabling accurate record linkage, personalized communication, and compliance with legal and regulatory requirements for data management.\nBusiness Rules: Last names are typically alphanumeric strings., May contain hyphens or apostrophes (e.g., O'Malley, Smith-Jones)., Case sensitivity may vary depending on system configuration., Should not be empty or null for valid individual records., May be subject to data standardization or normalization processes to handle variations in spelling or transliteration.", 'temporal_types': [], 'ui_type': 'choose', 'units': None, 'allow_vtb': True, 'allow_vte': True, 'allow_tr': True, 'allow_modified': False, 'allow_latitude': False, 'allow_longitude': False}, 'aiao7fzq1yqhw02vu564melh': {'label': 'Date of Birth', 'type': 'XdTemporal', 'required': False, 'constraints': {}, 'help_text': 'This column represents the date of birth for individuals. The data is consistently formatted and appears to be valid dates.\nBusiness Rules: Dates of birth must be valid calendar dates., Dates of birth should generally fall within a reasonable human lifespan (e.g., not in the future or excessively far in the past)., The format must be YYYY-MM-DD.', 'temporal_types': [], 'ui_type': 'choose', 'units': None, 'allow_vtb': True, 'allow_vte': True, 'allow_tr': True, 'allow_modified': False, 'allow_latitude': False, 'allow_longitude': False}}
